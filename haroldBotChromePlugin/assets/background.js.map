{"version":3,"sources":["webpack:///webpack/bootstrap 5a77184482f2424c03f9","webpack:///./background.js"],"names":["loadedUrl","songNames","serverIp","chrome","storage","sync","get","data","load","url","Promise","resolve","indexOf","push","console","log","req","XMLHttpRequest","open","responseType","onload","status","blob","response","size","toFixed","urlIndex","send","getName","i","reject","fileName","setTimeout","then","catch","flushMemory","length","uploadBlob","formData","FormData","append","getUserId","userId","warn","$","ajax","type","contentType","processData","success","res","clear","error","id","splice","filter","urls","webRequest","onSendHeaders","addListener","onChanged","area","newValue","lastSongName","createdTabIndex","tabs","create","active","tab","index","App","options","_self","catchedUrls","getUid","_refreshSocket","_createDiscordTab","newIp","socket","disconnect","ip","io"],"mappings":"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","file":"background.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5a77184482f2424c03f9","var loadedUrl = [],\r\n\tsongNames = [],\n\tserverIp\n\n\nchrome.storage.sync.get([\"serverIp\"], data => {\n\tserverIp = data.serverIp\n})\n\r\nfunction load (url) {\r\n\treturn new Promise((resolve) => {\r\n\t\tif (loadedUrl.indexOf(url) + 1) return\r\n\t\tloadedUrl.push(url)\r\n\r\n\t\tconsole.log(\"catched url: \", url);\r\n\r\n\t\tlet req = new XMLHttpRequest();\r\n\t\treq.open('GET', url, true);\r\n\t\treq.responseType = 'blob';\r\n\r\n\t\treq.onload = function() {\r\n\t\t\tif (this.status === 200) {\r\n\t\t\t\tvar blob = this.response;\r\n\t\t\t\tconsole.log(\"loaded file\", (blob.size / 1024 / 1024).toFixed(2) , \"mb\");\r\n\t\t\t\tresolve({\r\n\t\t\t\t\tblob: blob,\r\n\t\t\t\t\turlIndex: loadedUrl.indexOf(url)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treq.send();\r\n\t})\r\n}\r\n\r\nfunction getName(data, i = 0) {\r\n\tconsole.log(\"try to get name\", songNames, data.urlIndex);\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tif (songNames[data.urlIndex]) {\r\n\t\t\tconsole.log(\"name geted\", songNames[data.urlIndex])\r\n\t\t\tresolve({\r\n\t\t\t\tblob: data.blob,\r\n\t\t\t\tfileName: songNames[data.urlIndex],\r\n\t\t\t\turlIndex: data.urlIndex\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (i < 10) {\r\n\t\t\t\t\tgetName(data, i + 1)\r\n\t\t\t\t\t\t.then(resolve)\r\n\t\t\t\t\t\t.catch(reject)\r\n\t\t\t\t} else reject ()\r\n\t\t\t}, 100)\r\n\t\t}\r\n\t})\r\n}\r\n\r\nfunction flushMemory() {\r\n\treturn new Promise((resolve) => {\r\n\t\tif (loadedUrl.length != songNames.length) {\r\n\t\t\tconsole.log(\"flushing memory\");\r\n\t\t\tif (!songNames.length || loadedUrl.length) {\r\n\t\t\t\tloadedUrl = []\r\n\t\t\t\tsongNames = []\r\n\t\t\t} else {\r\n\t\t\t\tloadedUrl = [ loadedUrl[loadedUrl.length - 1] ]\r\n\t\t\t\tsongNames = [ songNames[songNames.length - 1] ]\r\n\t\t\t}\r\n\t\t}\r\n\t\tresolve()\r\n\t})\r\n}\r\n\r\nfunction uploadBlob(data){\r\n\tconsole.log(\"try to send data\");\r\n\tvar formData = new FormData()\r\n\tformData.append('kek', data.blob, data.fileName + '.mp3')\r\n\tgetUserId()\r\n\t\t.then(userId => {\r\n\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\tformData.append('userId', userId)\r\n\t\t\t\tresolve(formData)\r\n\t\t\t})\r\n\t\t})\r\n\t\t.then(formData => {\n\t\t\tif (!serverIp) {\n\t\t\t\tconsole.warn(\"not send, no server ip\")\n\t\t\t\treturn\n\t\t\t}\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: `http://${serverIp}:80/`,\r\n\t\t\t\tdata: formData,\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\tcontentType: false,\r\n\t\t\t\tprocessData: false,\r\n\t\t\t\tsuccess: function (res) {\r\n\t\t\t\t\tclear(data.urlIndex)\r\n\t\t\t\t\tconsole.log(\"sended, server responce:\", res);\r\n\t\t\t\t},\r\n\t\t\t\terror: function (res) {\r\n\t\t\t\t\tclear(data.urlIndex)\r\n\t\t\t\t\tconsole.warn(\"error, server responce:\", res);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n}\r\n\r\nfunction clear(id) {\r\n\tloadedUrl.splice(id, 1)\r\n\tsongNames.splice(id, 1)\r\n\tflushMemory()\r\n}\r\n\r\nvar filter = {\r\n\turls: [\"https://*.vk-cdn.net/*\", \"https://*.userapi.com/*/audios/*\", \"https://*.userapi.com/*.mp3?extra=*\"]\r\n}\r\n\r\nchrome.webRequest.onSendHeaders.addListener(data => {\r\n\tload (data.url)\r\n\t\t.then(getName)\r\n\t\t.then(uploadBlob)\r\n\t\t.catch(flushMemory)\r\n}, filter, [\"requestHeaders\"])\r\n\r\nchrome.storage.onChanged.addListener((data, area) => {\n\tif (data.serverIp && data.serverIp.newValue) {\n\t\tserverIp = data.serverIp.newValue\n\t}\n\tif (data.lastSongName && data.lastSongName.newValue) {\n\t\tconsole.log(\"geted song name\", data.lastSongName.newValue);\r\n\t\tsongNames.push(data.lastSongName.newValue)\n\t}\r\n})\r\n\r\n//chrome.webRequest.onHeadersReceived.addListener(, filter, [\"responseHeaders\"])\r\n\r\nvar createdTabIndex = false\r\n\r\nfunction getUserId(){\r\n\treturn new Promise((resolve) => {\r\n\t\tchrome.storage.sync.get([\"userId\"], (data) => {\r\n\t\t\tif (!data.userId) {\r\n\t\t\t\tif (!createdTabIndex) {\r\n\t\t\t\t\tchrome.tabs.create({\r\n\t\t\t\t\t\tactive: true,\r\n\t\t\t\t\t\turl: \"https://discordapp.com/channels/345551217918738432\"\r\n\t\t\t\t\t}, tab => {\r\n\t\t\t\t\t\tconsole.log(\"tab created with id\", tab.index);\r\n\t\t\t\t\t\tcreatedTabIndex = tab.index\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tgetUserId().then(resolve)\r\n\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tgetUserId().then(resolve)\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tresolve(data.userId)\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n}\r\n\r\ngetUserId().then(userId => {\r\n\tconsole.log(userId)\r\n})\n\nclass App {\n\tconstructor(options){\n\t\tvar _self = this\n\n\t\tthis.songNames = []\n\t\tthis.catchedUrls = []\n\t}\n\n\tasync init (data) {\n\t\tif (!data.userId) {\n\t\t\tdata.userId = await this.getUid()\n\t\t}\n\t\tthis.userId = data.userId\n\t\tthis._refreshSocket(data.serverIp)\n\t\treturn console.log(\"init\")\n\t}\n\n\tasync getUid () {\n\t\tvar _self = this\n\t\tif (_self.createdTabIndex) {\n\t\t\tsetTimeout(() => {\n\t\t\t\treturn _self.getUid()\n\t\t\t}, 1000)\n\t\t} else {\n\t\t\t_self._createDiscordTab()\n\t\t}\n\t}\n\n\tasync _createDiscordTab () {\n\t\tvar _self = this\n\t\tchrome.tabs.create({\n\t\t\tactive: true,\n\t\t\turl: \"https://discordapp.com/channels/345551217918738432\"\n\t\t}, tab => {\n\t\t\tconsole.log(\"tab created with id\", tab.index);\n\n\t\t\tcreatedTabIndex = tab.index\n\t\t\tsetTimeout(() => {\n\t\t\t\tgetUserId().then(resolve)\n\t\t\t}, 1000)\n\t\t})\n\t}\n\n\tcatchRequest (data) {\n\n\t}\n\n\tstorageChanged (data, area) {\n\t\tif (data.serverIp && data.serverIp.newValue) {\n\t\t\tthis._refreshSocket(data.serverIp.newValue)\n\t\t}\n\n\t\tif (data.lastSongName && data.lastSongName.newValue) {\n\t\t\tconsole.log(\"geted song name\", data.lastSongName.newValue);\n\t\t\tthis.songNames.push(data.lastSongName.newValue)\n\t\t}\n\t}\n\n\t_refreshSocket (newIp) {\n\t\tif (this.socket) this.socket.disconnect()\n\t\tif (this.ip == newIp) return this.socket\n\n\t\tthis.ip = newIp\n\t\tthis.socket = io(`http://${newIp}:2302/`)\n\n\t\treturn this.socket\n\t}\n}\n\n\n//let filter = {urls: [\"https://*.vk-cdn.net/*\", \"https://*.userapi.com/*/audios/*\", \"https://*.userapi.com/*.mp3?extra=*\"]}\n\n/*\nvar app = new App()\n\n$(async function () {\n\n\n\tchrome.storage.sync.get([\"serverIp\", \"userId\"], app.init)\n\n\tchrome.webRequest.onSendHeaders.addListener(app.catchRequest, filter, [\"requestHeaders\"])\n\tchrome.storage.onChanged.addListener(app.storageChanged)\n})\n*/\n\n\n\n// WEBPACK FOOTER //\n// ./background.js"],"sourceRoot":""}